{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[{"file_id":"1pxxhkWFA1ynQM49XsRRfi1hm9TKJHz3j","timestamp":1712585917915}],"gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"e8ec615b0b3e43e2a8f24cc0339f25fb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_df80d78d38204d02b4efa7fdca82abc3","IPY_MODEL_2a1406f2c20943d68624ef6af55cf666","IPY_MODEL_bc75e2d8a95249bda17e70619658ae68"],"layout":"IPY_MODEL_f5a6a9ef69e94faabb94867f0397aad0"}},"df80d78d38204d02b4efa7fdca82abc3":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_2bda755f15e8481999cdfbda60466255","placeholder":"​","style":"IPY_MODEL_90e9cdb951fd464a88eb24c64e0d6d54","value":"Downloading data: 100%"}},"2a1406f2c20943d68624ef6af55cf666":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_7bdca5e9c7404de3bac6484e360d7be6","max":732610,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0c7094fd1c8e4493a32e36e5f1f7eb75","value":732610}},"bc75e2d8a95249bda17e70619658ae68":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_12b6073600eb44b58ebfceb7256dc3d8","placeholder":"​","style":"IPY_MODEL_2c757e202cc94c8499f1d86f5eeeeac7","value":" 733k/733k [00:00&lt;00:00, 1.98MB/s]"}},"f5a6a9ef69e94faabb94867f0397aad0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2bda755f15e8481999cdfbda60466255":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"90e9cdb951fd464a88eb24c64e0d6d54":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7bdca5e9c7404de3bac6484e360d7be6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0c7094fd1c8e4493a32e36e5f1f7eb75":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"12b6073600eb44b58ebfceb7256dc3d8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2c757e202cc94c8499f1d86f5eeeeac7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"0a1314c00dfb485b82e5b9a228df36db":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_27d5ca62a6d74f46a5fed8871953db83","IPY_MODEL_bcb342c48069439081ee9e48966fb0d6","IPY_MODEL_9cc5b30051ef4109879ede6af15cd19e"],"layout":"IPY_MODEL_856c8e0a070b48e5bfb13fed477abb9f"}},"27d5ca62a6d74f46a5fed8871953db83":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_30e966b266f5400e85a426e6c0a594b5","placeholder":"​","style":"IPY_MODEL_df45c37623f84155817c186d785606ce","value":"Downloading data: 100%"}},"bcb342c48069439081ee9e48966fb0d6":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ef33546dc3074256b5e3b1e7bf832ce5","max":156987808,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8028dfe8434a4a819523917380218ee6","value":156987808}},"9cc5b30051ef4109879ede6af15cd19e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_52b04c6fa0084e608b696525dea9ce77","placeholder":"​","style":"IPY_MODEL_61940c620e9549a29ff461de2ae55cbb","value":" 157M/157M [01:26&lt;00:00, 2.13MB/s]"}},"856c8e0a070b48e5bfb13fed477abb9f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"30e966b266f5400e85a426e6c0a594b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"df45c37623f84155817c186d785606ce":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ef33546dc3074256b5e3b1e7bf832ce5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8028dfe8434a4a819523917380218ee6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"52b04c6fa0084e608b696525dea9ce77":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"61940c620e9549a29ff461de2ae55cbb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"167da6826a3146f88d95aa71902adddd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_0ad4a67955eb403bb0cd1d8e48e53987","IPY_MODEL_18bf9397bba5444eba103e4328ed3bb9","IPY_MODEL_66d87b81ecac4daeb45f7948c8eda4af"],"layout":"IPY_MODEL_a89fba07609c49859fb2b131f07d9f69"}},"0ad4a67955eb403bb0cd1d8e48e53987":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_761fe35d7b0c456bacda2ed16b7fb3bb","placeholder":"​","style":"IPY_MODEL_a7d7ff93adbe4b18a784ade56ce9e4ec","value":"Downloading data: 100%"}},"18bf9397bba5444eba103e4328ed3bb9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d959c3315bfa4d69b27e301ee89a18af","max":157088770,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b1e47ec8bdd7484e96a0c36bb7329a1d","value":157088770}},"66d87b81ecac4daeb45f7948c8eda4af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_898548647e284091aee0afdf064b053e","placeholder":"​","style":"IPY_MODEL_de603f5f053a452b8c03a5d5a5b6715f","value":" 157M/157M [00:06&lt;00:00, 26.5MB/s]"}},"a89fba07609c49859fb2b131f07d9f69":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"761fe35d7b0c456bacda2ed16b7fb3bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a7d7ff93adbe4b18a784ade56ce9e4ec":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d959c3315bfa4d69b27e301ee89a18af":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b1e47ec8bdd7484e96a0c36bb7329a1d":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"898548647e284091aee0afdf064b053e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"de603f5f053a452b8c03a5d5a5b6715f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"6762ef3b9b1248acb9b350b80c2e6c0d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cd60cb36cedf4d3280005ee98a4153a0","IPY_MODEL_e93ac448e9cc41719d99bbd857d98160","IPY_MODEL_ea1d23f2b2d040b6b8b3fb3f4c6a7513"],"layout":"IPY_MODEL_2aba6af0412147639442b22ac7a4a7a1"}},"cd60cb36cedf4d3280005ee98a4153a0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a86c328f102844e583cfd5c33eb31cd3","placeholder":"​","style":"IPY_MODEL_06045c23e7bb43618544c491547fdd25","value":"Downloading data: 100%"}},"e93ac448e9cc41719d99bbd857d98160":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_60f0b8149acd4a3687112b10c226ba94","max":657209,"min":0,"orientation":"horizontal","style":"IPY_MODEL_368ddf5c8ed24894a3fa35b6d52503a9","value":657209}},"ea1d23f2b2d040b6b8b3fb3f4c6a7513":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_158f3702d21d4cabbc60f287a11160c0","placeholder":"​","style":"IPY_MODEL_1abbb36c70c84dc788c5a29b1f87453c","value":" 657k/657k [00:00&lt;00:00, 2.26MB/s]"}},"2aba6af0412147639442b22ac7a4a7a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a86c328f102844e583cfd5c33eb31cd3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"06045c23e7bb43618544c491547fdd25":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"60f0b8149acd4a3687112b10c226ba94":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"368ddf5c8ed24894a3fa35b6d52503a9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"158f3702d21d4cabbc60f287a11160c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"1abbb36c70c84dc788c5a29b1f87453c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8c0b460d5c0f4a69b35876071b74024a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_6edca3c2c4ab4197ad352f0043cd9962","IPY_MODEL_1cac9c89c0bf421a88cd211aec50760a","IPY_MODEL_9aff13a43e6d43e1bfae8ee47bb58ca6"],"layout":"IPY_MODEL_3b2945011f094095affaa2e12bd2bab3"}},"6edca3c2c4ab4197ad352f0043cd9962":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a2b1a834b1c347cf8c0bf5c436578f2b","placeholder":"​","style":"IPY_MODEL_5b76ac8364844858b942fb7f4a88fc7f","value":"Generating test split: 100%"}},"1cac9c89c0bf421a88cd211aec50760a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_f656afe181954e428456ff5997054ab1","max":4358,"min":0,"orientation":"horizontal","style":"IPY_MODEL_4ff37285ae144a6b99cc114761772bcf","value":4358}},"9aff13a43e6d43e1bfae8ee47bb58ca6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b06db40d895848ea894a74653dd2d61e","placeholder":"​","style":"IPY_MODEL_2f1c9982d75f472cbc4a41f8f4b3d0d4","value":" 4358/4358 [00:00&lt;00:00, 105415.15 examples/s]"}},"3b2945011f094095affaa2e12bd2bab3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a2b1a834b1c347cf8c0bf5c436578f2b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5b76ac8364844858b942fb7f4a88fc7f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"f656afe181954e428456ff5997054ab1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"4ff37285ae144a6b99cc114761772bcf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"b06db40d895848ea894a74653dd2d61e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2f1c9982d75f472cbc4a41f8f4b3d0d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"8d3b89deae9d454c9a82481681520f37":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_145c15ff974c4d8baaca485b18af5a0e","IPY_MODEL_9a82e6fb5d394892a2f702f7ddee91f9","IPY_MODEL_8a174d32980545d1a4ccc37d6b39fae5"],"layout":"IPY_MODEL_99cb41d62cbe424c927c9d76763aaf27"}},"145c15ff974c4d8baaca485b18af5a0e":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a0d507ae290b4c43b59f5b2316136885","placeholder":"​","style":"IPY_MODEL_85fbaae540b643db89111e89f979a9c9","value":"Generating train split: 100%"}},"9a82e6fb5d394892a2f702f7ddee91f9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_47c5dddda6f34171b5f018ab8bfbaa97","max":1801350,"min":0,"orientation":"horizontal","style":"IPY_MODEL_106daa3b06d44d979b31874b8b239c66","value":1801350}},"8a174d32980545d1a4ccc37d6b39fae5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7ad1febc7ab949b3978b6650b014dc3f","placeholder":"​","style":"IPY_MODEL_a6fb0093eb614ba58a8d2d00fd5e3e3e","value":" 1801350/1801350 [00:03&lt;00:00, 501207.78 examples/s]"}},"99cb41d62cbe424c927c9d76763aaf27":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a0d507ae290b4c43b59f5b2316136885":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"85fbaae540b643db89111e89f979a9c9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"47c5dddda6f34171b5f018ab8bfbaa97":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"106daa3b06d44d979b31874b8b239c66":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7ad1febc7ab949b3978b6650b014dc3f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"a6fb0093eb614ba58a8d2d00fd5e3e3e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"e931ac63028448e7aab897b08a6709bd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_56c4097b0b23459f9a35daf1174557ea","IPY_MODEL_e3024ba2a508444784ed728cd6bc256a","IPY_MODEL_44e47cb9bcef49728cc161577f45f80f"],"layout":"IPY_MODEL_9bcdd34ca6f94b3aa5d935d078bf23a1"}},"56c4097b0b23459f9a35daf1174557ea":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_711af0ff54fc402db7b0c58c0d4f0615","placeholder":"​","style":"IPY_MODEL_0a8213d9e57045f8b6e900e9acf84484","value":"Generating validation split: 100%"}},"e3024ba2a508444784ed728cd6bc256a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_abbd2c2bddb8454bb0b595cccd63c398","max":3760,"min":0,"orientation":"horizontal","style":"IPY_MODEL_2ddbe07c2627470c96c875f21e84e660","value":3760}},"44e47cb9bcef49728cc161577f45f80f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7375f559f3584103968e5068373aa4fb","placeholder":"​","style":"IPY_MODEL_337448bde6de4937b38c1fe0f49aa16a","value":" 3760/3760 [00:00&lt;00:00, 91933.70 examples/s]"}},"9bcdd34ca6f94b3aa5d935d078bf23a1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"711af0ff54fc402db7b0c58c0d4f0615":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a8213d9e57045f8b6e900e9acf84484":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"abbd2c2bddb8454bb0b595cccd63c398":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"2ddbe07c2627470c96c875f21e84e660":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7375f559f3584103968e5068373aa4fb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"337448bde6de4937b38c1fe0f49aa16a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"a39c3e33871444259c68eebc70b157dc":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_09c010e0e4b44d3e8970505747aa714c","IPY_MODEL_4ddac14d21ed4060bfb8817f94a5a54c","IPY_MODEL_2c2aaac2005d445cb489667b8d611b78"],"layout":"IPY_MODEL_229ffee694204b8aab06e7bb6a57b78a"}},"09c010e0e4b44d3e8970505747aa714c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7de9dc062be14915949acb48929da787","placeholder":"​","style":"IPY_MODEL_7b466dfadc7f4055a738a0d2a4e98f94","value":"Map (num_proc=4): 100%"}},"4ddac14d21ed4060bfb8817f94a5a54c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_b45bc1e0bee2442081a12664ad8490c6","max":1000,"min":0,"orientation":"horizontal","style":"IPY_MODEL_0bab75b4b35b4452acdaa2c329963328","value":1000}},"2c2aaac2005d445cb489667b8d611b78":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_7410443f96634a109fc0a12e67b5b964","placeholder":"​","style":"IPY_MODEL_0e1fc86039d04e168f5730b907957736","value":" 1000/1000 [00:01&lt;00:00, 1350.63 examples/s]"}},"229ffee694204b8aab06e7bb6a57b78a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7de9dc062be14915949acb48929da787":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7b466dfadc7f4055a738a0d2a4e98f94":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b45bc1e0bee2442081a12664ad8490c6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0bab75b4b35b4452acdaa2c329963328":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"7410443f96634a109fc0a12e67b5b964":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0e1fc86039d04e168f5730b907957736":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"markdown","source":["# 사전학습 튜토리얼"],"metadata":{"id":"6ojuBCPCMM39"}},{"cell_type":"markdown","source":["<img src=\"https://i.imgur.com/2PFsDH5.png\" width=\"700px\" />"],"metadata":{"id":"ENnNS9M0MbHE"}},{"cell_type":"markdown","source":["라이브러리 설치 후 런타임 재시작"],"metadata":{"id":"KIi93nMKMQUw"}},{"cell_type":"code","source":["!pip install transformers datasets accelerate -qqq"],"metadata":{"id":"9oKuHiWAvers","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712586046863,"user_tz":-540,"elapsed":99645,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"b1872a44-c71d-445a-d996-11118e06d4e4"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m510.5/510.5 kB\u001b[0m \u001b[31m8.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m297.3/297.3 kB\u001b[0m \u001b[31m23.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m116.3/116.3 kB\u001b[0m \u001b[31m10.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m194.1/194.1 kB\u001b[0m \u001b[31m16.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m134.8/134.8 kB\u001b[0m \u001b[31m13.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m23.7/23.7 MB\u001b[0m \u001b[31m28.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m823.6/823.6 kB\u001b[0m \u001b[31m43.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m14.1/14.1 MB\u001b[0m \u001b[31m52.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m731.7/731.7 MB\u001b[0m \u001b[31m2.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m410.6/410.6 MB\u001b[0m \u001b[31m2.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m121.6/121.6 MB\u001b[0m \u001b[31m8.7 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m56.5/56.5 MB\u001b[0m \u001b[31m14.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m124.2/124.2 MB\u001b[0m \u001b[31m8.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m196.0/196.0 MB\u001b[0m \u001b[31m6.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m166.0/166.0 MB\u001b[0m \u001b[31m7.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m99.1/99.1 kB\u001b[0m \u001b[31m13.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m21.1/21.1 MB\u001b[0m \u001b[31m52.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25h"]}]},{"cell_type":"markdown","source":[],"metadata":{"id":"W6RAo8b8FNgX"}},{"cell_type":"markdown","source":["## 1.작업정의\n","\n","한국어 위키 데이터세트로 문장생성 모델(GPT-2) 사전학습 하기"],"metadata":{"id":"jrhbqqa3MgpW"}},{"cell_type":"markdown","source":["## 2.학습 데이터 로딩"],"metadata":{"id":"deIIUkx-Mudu"}},{"cell_type":"code","execution_count":3,"metadata":{"id":"0UyRsJC9slyD","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712586184185,"user_tz":-540,"elapsed":3979,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"1992d5cf-47d5-4981-92fd-9b991fefec3b"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset({\n","    features: ['text'],\n","    num_rows: 1000\n","})"]},"metadata":{},"execution_count":3}],"source":["from datasets import load_dataset\n","\n","train_dataset = load_dataset('wikitext', 'wikitext-2-v1', split='train[:1000]')\n","train_dataset\n"]},{"cell_type":"code","source":["train_dataset[4]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Cx35v9QvI9YW","executionInfo":{"status":"ok","timestamp":1712587006661,"user_tz":-540,"elapsed":1,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"dc98931a-dbf3-4146-d0b9-7db4b0dabd68"},"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'text': \" The game began development in 2010 , carrying over a large portion of the work done on Valkyria Chronicles II . While it retained the standard features of the series , it also underwent multiple adjustments , such as making the game more <unk> for series newcomers . Character designer <unk> Honjou and composer Hitoshi Sakimoto both returned from previous entries , along with Valkyria Chronicles II director Takeshi Ozawa . A large team of writers handled the script . The game 's opening theme was sung by May 'n . \\n\"}"]},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["train_dataset[4]['text']"],"metadata":{"id":"Cr5ernO_OQzX","colab":{"base_uri":"https://localhost:8080/","height":122},"executionInfo":{"status":"ok","timestamp":1712586408402,"user_tz":-540,"elapsed":2,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"df875b23-6272-4fb3-f025-b7b767b07a77"},"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/plain":["\" The game began development in 2010 , carrying over a large portion of the work done on Valkyria Chronicles II . While it retained the standard features of the series , it also underwent multiple adjustments , such as making the game more <unk> for series newcomers . Character designer <unk> Honjou and composer Hitoshi Sakimoto both returned from previous entries , along with Valkyria Chronicles II director Takeshi Ozawa . A large team of writers handled the script . The game 's opening theme was sung by May 'n . \\n\""],"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"}},"metadata":{},"execution_count":13}]},{"cell_type":"markdown","source":["## 3.토크나이저 설정 및 학습"],"metadata":{"id":"_9B2sB_gM5PR"}},{"cell_type":"code","source":["from tokenizers import ByteLevelBPETokenizer\n","\n","tokenizer = ByteLevelBPETokenizer()\n","tokenizer\n"],"metadata":{"id":"QcRttky9vVve","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712587056650,"user_tz":-540,"elapsed":2,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"3ce27480-595f-4975-c12f-fd8e65a90150"},"execution_count":16,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Tokenizer(vocabulary_size=0, model=ByteLevelBPE, add_prefix_space=False, lowercase=False, dropout=None, unicode_normalizer=None, continuing_subword_prefix=None, end_of_word_suffix=None, trim_offsets=False)"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["import os\n","with open('./wikitext.txt', 'w', encoding='utf-8') as f:\n","    for data in train_dataset:\n","        f.write(data['text'] + '\\n')\n","files = ['./wikitext.txt']"],"metadata":{"id":"aUR1df14GcSV","executionInfo":{"status":"ok","timestamp":1712587082704,"user_tz":-540,"elapsed":1,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["vocab_size = 1000\n","tokenizer.train(files, vocab_size=vocab_size, min_frequency=2, special_tokens=[\n","    '<s>',\n","    '<pad>',\n","    '</s>',\n","    '<unk>',\n","    '<mask>'\n","])\n","\n"],"metadata":{"id":"kAuPkxTbGgOB","executionInfo":{"status":"ok","timestamp":1712587248578,"user_tz":-540,"elapsed":1,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}}},"execution_count":19,"outputs":[]},{"cell_type":"code","source":["tokenizer"],"metadata":{"id":"Ua3v35LVGjIj","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712587258998,"user_tz":-540,"elapsed":3,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"46b5e1a6-a5a2-4417-8602-a32940814018"},"execution_count":20,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Tokenizer(vocabulary_size=1000, model=ByteLevelBPE, add_prefix_space=False, lowercase=False, dropout=None, unicode_normalizer=None, continuing_subword_prefix=None, end_of_word_suffix=None, trim_offsets=False)"]},"metadata":{},"execution_count":20}]},{"cell_type":"code","source":["tokenizer.save_model('./my_gpt_model/')\n"],"metadata":{"id":"cgVlBNocNPOw","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712587309636,"user_tz":-540,"elapsed":551,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"e4da87c9-aa58-41f3-901a-3b98423add4f"},"execution_count":22,"outputs":[{"output_type":"execute_result","data":{"text/plain":["['./my_gpt_model/vocab.json', './my_gpt_model/merges.txt']"]},"metadata":{},"execution_count":22}]},{"cell_type":"code","source":["from transformers import GPT2Tokenizer\n","\n","\n","# GPT2 모델에 특화된 토크나이저로 변환\n","new_tokenizer = GPT2Tokenizer.from_pretrained('my_gpt_model')\n","new_tokenizer.pad_token_id = tokenizer.token_to_id('<pad>')\n","new_tokenizer.bos_token_id = tokenizer.token_to_id('<s>')\n","new_tokenizer.eos_token_id = tokenizer.token_to_id('</s>')\n","\n","new_tokenizer.save_pretrained('my_gpt_model')"],"metadata":{"id":"rYyIh5A-Ok1V","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712587522186,"user_tz":-540,"elapsed":497,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"de8d43f1-fa4f-4bbb-9165-111ac01c9c4d"},"execution_count":24,"outputs":[{"output_type":"execute_result","data":{"text/plain":["('my_gpt_model/tokenizer_config.json',\n"," 'my_gpt_model/special_tokens_map.json',\n"," 'my_gpt_model/vocab.json',\n"," 'my_gpt_model/merges.txt',\n"," 'my_gpt_model/added_tokens.json')"]},"metadata":{},"execution_count":24}]},{"cell_type":"markdown","source":["## 4.빈 모델(GPT2) 로딩 : GPT2Config"],"metadata":{"id":"OsEfXatSNC2E"}},{"cell_type":"code","source":["from transformers import GPT2Config, GPT2LMHeadModel\n","\n","vocab_size = 1000\n","config = GPT2Config(\n","    vocab_size=vocab_size,\n","    bos_token_id=tokenizer.token_to_id('<s>'),\n","    eos_token_id=tokenizer.token_to_id('</s>')\n",")\n","\n","\n","model = GPT2LMHeadModel(config)\n"],"metadata":{"id":"i6CNc06Gw3GW","executionInfo":{"status":"ok","timestamp":1712587704826,"user_tz":-540,"elapsed":2769,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["model"],"metadata":{"id":"ujhs_PywPxwZ","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712587704826,"user_tz":-540,"elapsed":6,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"30dae268-2b16-402e-de02-13764fc27d83"},"execution_count":27,"outputs":[{"output_type":"execute_result","data":{"text/plain":["GPT2LMHeadModel(\n","  (transformer): GPT2Model(\n","    (wte): Embedding(1000, 768)\n","    (wpe): Embedding(1024, 768)\n","    (drop): Dropout(p=0.1, inplace=False)\n","    (h): ModuleList(\n","      (0-11): 12 x GPT2Block(\n","        (ln_1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","        (attn): GPT2Attention(\n","          (c_attn): Conv1D()\n","          (c_proj): Conv1D()\n","          (attn_dropout): Dropout(p=0.1, inplace=False)\n","          (resid_dropout): Dropout(p=0.1, inplace=False)\n","        )\n","        (ln_2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","        (mlp): GPT2MLP(\n","          (c_fc): Conv1D()\n","          (c_proj): Conv1D()\n","          (act): NewGELUActivation()\n","          (dropout): Dropout(p=0.1, inplace=False)\n","        )\n","      )\n","    )\n","    (ln_f): LayerNorm((768,), eps=1e-05, elementwise_affine=True)\n","  )\n","  (lm_head): Linear(in_features=768, out_features=1000, bias=False)\n",")"]},"metadata":{},"execution_count":27}]},{"cell_type":"markdown","source":["## 5.학습 데이터 전처리"],"metadata":{"id":"4jfV2X1FNY28"}},{"cell_type":"markdown","source":["### 토크나이징"],"metadata":{"id":"A2yEZJ_mNn_h"}},{"cell_type":"code","source":["from transformers import GPT2Tokenizer\n","\n","tokenizer = GPT2Tokenizer.from_pretrained('my_gpt_model')\n","\n","def tokenize_function(examples):\n","    return tokenizer(examples[\"text\"], padding=\"max_length\", truncation=True, max_length=20)\n","\n","tokenized_datasets = train_dataset.map(tokenize_function, batched=True, num_proc=4, remove_columns=[\"text\"])"],"metadata":{"id":"P73_V7u2ISEX","executionInfo":{"status":"ok","timestamp":1712587959279,"user_tz":-540,"elapsed":495,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}}},"execution_count":40,"outputs":[]},{"cell_type":"code","source":["tokenized_datasets[3]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xki3yk_OMaFK","executionInfo":{"status":"ok","timestamp":1712587959744,"user_tz":-540,"elapsed":2,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"28526afb-7ab7-43e7-94b0-07b765e3e7d1"},"execution_count":41,"outputs":[{"output_type":"execute_result","data":{"text/plain":["{'input_ids': [322,\n","  284,\n","  78,\n","  134,\n","  240,\n","  775,\n","  752,\n","  584,\n","  612,\n","  292,\n","  289,\n","  34,\n","  924,\n","  390,\n","  429,\n","  482,\n","  293,\n","  282,\n","  73,\n","  612],\n"," 'attention_mask': [1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1,\n","  1]}"]},"metadata":{},"execution_count":41}]},{"cell_type":"code","source":[],"metadata":{"id":"kwj0MldnMZI0"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["### 배치처리"],"metadata":{"id":"wQdQW_yaNpt8"}},{"cell_type":"markdown","source":["DataCollatorForLanguageModeling"],"metadata":{"id":"8JUAiDIuMivz"}},{"cell_type":"markdown","source":[],"metadata":{"id":"v7hQDNqKMtTh"}},{"cell_type":"code","source":["from transformers import DataCollatorForLanguageModeling\n","\n","data_collator = DataCollatorForLanguageModeling(tokenizer=tokenizer, mlm=False)\n","data_collator"],"metadata":{"id":"ko1WApKjxYYF","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712588032778,"user_tz":-540,"elapsed":2,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"28371880-d751-414a-c962-c2640ded9cd4"},"execution_count":43,"outputs":[{"output_type":"execute_result","data":{"text/plain":["DataCollatorForLanguageModeling(tokenizer=GPT2Tokenizer(name_or_path='my_gpt_model', vocab_size=1000, model_max_length=1000000000000000019884624838656, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<s>', 'eos_token': '</s>', 'unk_token': '<|endoftext|>', 'pad_token': '<pad>'}, clean_up_tokenization_spaces=True),  added_tokens_decoder={\n","\t0: AddedToken(\"<s>\", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),\n","\t1: AddedToken(\"<pad>\", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),\n","\t2: AddedToken(\"</s>\", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),\n","\t1000: AddedToken(\"<|endoftext|>\", rstrip=False, lstrip=False, single_word=False, normalized=True, special=True),\n","}, mlm=False, mlm_probability=0.15, pad_to_multiple_of=None, tf_experimental_compile=False, return_tensors='pt')"]},"metadata":{},"execution_count":43}]},{"cell_type":"markdown","source":["## 6.모델 훈련"],"metadata":{"id":"B8X6y9pjNqwP"}},{"cell_type":"code","source":["from transformers import Trainer, TrainingArguments\n","\n","training_args = TrainingArguments(\n","    output_dir = './my_gpt_model',\n","    overwrite_output_dir = True,\n","    num_train_epochs = 1,\n","    per_device_train_batch_size = 8,\n","    save_steps = 100,\n","    save_total_limit = 2\n",")\n","\n","trainer = Trainer(\n","    model=model,\n","    args = training_args,\n","    train_dataset=tokenized_datasets,\n","    data_collator=data_collator\n",")\n","\n","trainer.train()\n","\n"],"metadata":{"id":"_4FSwq2qxcxg","colab":{"base_uri":"https://localhost:8080/","height":199},"executionInfo":{"status":"ok","timestamp":1712588184044,"user_tz":-540,"elapsed":22579,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"16f49c41-1769-4acc-9f0c-69ed3683955c"},"execution_count":45,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/accelerate/accelerator.py:436: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: \n","dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='125' max='125' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [125/125 00:18, Epoch 1/1]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=125, training_loss=5.73873681640625, metrics={'train_runtime': 21.4025, 'train_samples_per_second': 46.724, 'train_steps_per_second': 5.84, 'total_flos': 10206720000000.0, 'train_loss': 5.73873681640625, 'epoch': 1.0})"]},"metadata":{},"execution_count":45}]},{"cell_type":"markdown","source":["## 7.모델 추론"],"metadata":{"id":"pv5HAeylNvOW"}},{"cell_type":"code","source":["# 1) 질의 문장\n","input_text = 'what is artificial intelligent?'\n","\n","\n","\n","\n","# 2) 토큰화하고 텐서로 변환합니다.\n","input_ids = tokenizer.encode(input_text, return_tensors=\"pt\")\n","input_ids = input_ids.to('cuda')\n","\n","\n","\n","\n","# 3) 생성 옵션을 설정하고 텍스트를 생성합니다.\n","max_length = 500\n","model = model.to(\"cuda\")\n","\n","\n","sample_outputs = model.generate(input_ids, do_sample=True, max_length=max_length, temperature=0.7)\n","\n","\n","\n","\n","\n","# 4) 생성된 텍스트를 디코딩합니다.\n","print(tokenizer.decode(sample_outputs[0], skip_special_tokens=True))\n","\n"],"metadata":{"id":"Ysq7tn7rKX83","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712588307388,"user_tz":-540,"elapsed":8072,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"f20d7594-2266-4faa-e7e1-6157ee939571"},"execution_count":46,"outputs":[{"output_type":"stream","name":"stderr","text":["The attention mask and the pad token id were not set. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.\n","Setting `pad_token_id` to `eos_token_id`:2 for open-end generation.\n"]},{"output_type":"stream","name":"stdout","text":["what is artificial intelligent?orent paalese thenyfs ,es ofa ands (,,ed ofal to toed ther S min m of of thec of of thes for <unk>esn, d,,'to, my, to the S'of the of and,r c was of the p the por and ;, theo W,entor  andunk>,t a theico, theit iny the to theed, p, in the the in ani ded of '>or the a the the thenn to,u the thes theiced ino of theuer and the ofal,ede,,s,aors l, the S <unk> thee'ofr the the in ', pt inu, the H ; of theers waser of toal ',ingentingunk>, of the to,er <unk>s,s in theed thea Hu l foras withst a dy the to and of they theic,it in <unk> and a wasal in, theeedununk> then andunk> the the toer the c the theeditfe c, <unk>al,edingon to and c and of the to theymu theor and ci,ingting the of in,ly and ofs inu H for for of the, ining f, ;it of, of of of and <unk> ; p foredit the,f, theonaalm c fses the, dic>e the, the S, the cer of in was theesn, ;n theeralitss, in theent in ofr ine c ofis of tos they m in the wasal ;i in the, and ai, and to,n>ing of wasou,,>serttunk>in pin,ed to d, thesa ofed theing ;nsic in thee in, wasor ;m p>ic andu ofal, ofed thes pitunk> ded of the the H, was,aying mer\n"]}]},{"cell_type":"code","source":["sample_outputs"],"metadata":{"id":"gVG5EJvKKX08","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1712588346188,"user_tz":-540,"elapsed":1,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"a4864a68-bb75-4b8d-c86e-ce92f44446a8"},"execution_count":47,"outputs":[{"output_type":"execute_result","data":{"text/plain":["tensor([[ 91,  76, 276, 397, 509,  88, 759, 459, 549, 688, 345, 317,  35, 277,\n","         317, 288,  69, 290, 282,  73, 265,  82,  93,  74,  87, 225, 268, 282,\n","         283,  69, 295,  87, 390, 268, 268, 273, 283, 290, 299, 299, 273, 265,\n","          86, 322, 298, 264, 298, 283, 283, 265,  71, 283, 283, 265,  87, 331,\n","         292, 289,  34, 282,  82, 268, 297, 268, 268, 353, 299, 268, 298,  93,\n","         268, 299, 265, 322, 353, 283, 265, 283, 295, 268,  86, 281, 325, 283,\n","         265, 288, 265, 288, 277, 295, 455, 268, 265,  83, 407, 268, 317, 277,\n","         225, 295, 289,  34, 268,  88, 263, 265, 302,  83, 268, 265, 278, 285,\n","          93, 265, 299, 265, 273, 268, 288, 268, 285, 265, 265, 285, 391,  77,\n","         297, 273, 283, 353,  34, 277, 265, 225,  69, 265, 265, 265,  82,  82,\n","         299, 268,  89, 265, 265,  87, 265, 302, 273, 285,  83, 283, 265,  89,\n","         266, 295, 265, 283, 290, 268, 273,  73, 268, 268,  87, 268,  69, 277,\n","          87, 320, 268, 265, 322, 292, 289,  34, 265,  73, 353, 283,  86, 265,\n","         265, 285, 353, 268, 288,  88, 285,  89, 268, 265, 361, 455, 283, 265,\n","         266,  87, 325, 266, 283, 299, 290, 353, 268, 291, 317, 291, 289,  34,\n","         268, 283, 265, 299, 268, 266, 292, 289,  34,  87, 268,  87, 285, 265,\n","         273, 265,  69, 361,  89, 320, 331,  69,  87, 346,  87,  88, 263, 297,\n","          93, 265, 299, 295, 283, 265,  93, 265, 302, 268, 278, 285, 292, 289,\n","          34, 295, 263, 325, 290, 285, 268, 265,  73, 273,  89,  82, 289,  34,\n","         265,  82, 295, 289,  34, 265, 265, 299, 266, 265, 281, 265, 265, 273,\n","         278,  74,  73, 281, 268, 292, 289,  34, 290, 268, 273, 291, 271, 299,\n","         295, 281, 295, 283, 265, 299, 265,  93,  81,  89, 265, 277, 295, 281,\n","          77, 268, 291,  88, 291, 265, 283, 285, 268, 311, 295, 283,  87, 285,\n","          89, 361, 331, 331, 283, 265, 268, 285, 291, 280, 268, 455, 278, 283,\n","         268, 283, 283, 283, 295, 292, 289,  34, 455, 288, 331, 273, 278, 265,\n","         268,  74, 268, 265, 271,  69, 290,  81, 281, 280,  87, 282, 265, 268,\n","         297, 302,  34,  73, 265, 268, 265, 322, 268, 265, 281, 266, 283, 285,\n","         325, 265, 282,  82, 268, 455,  82, 265, 266, 290, 278,  87,  87, 268,\n","         285, 265, 317, 285, 283,  86, 285,  73, 281, 283,  77,  87, 283, 299,\n","          87, 265,  93, 298, 285, 265, 325, 290, 455,  77, 285, 265, 268, 295,\n","         263,  77, 268, 295, 299, 268,  82,  34, 291, 283, 325,  83,  89, 268,\n","         268,  34,  87, 266,  88,  88, 289,  34, 264, 288, 264, 268, 273, 299,\n","         297, 268, 265,  87,  69, 283, 273, 265, 291, 455,  82,  87, 302, 285,\n","         265,  73, 285, 268, 325, 277, 455,  81, 288,  34, 302, 295,  89, 283,\n","         290, 268, 283, 273, 265,  87, 288, 278, 289,  34, 297, 273, 283, 265,\n","         265, 361, 268, 325, 268, 340, 291, 225,  81, 266]], device='cuda:0')"]},"metadata":{},"execution_count":47}]},{"cell_type":"code","source":[],"metadata":{"id":"xa7Gt3n3KXx6"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"A21PcG3yL7fJ"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"cleM6R-HL7av"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# 전체 코드"],"metadata":{"id":"xmCopL6qMDKK"}},{"cell_type":"code","source":["from transformers import GPT2Config, GPT2LMHeadModel, GPT2Tokenizer\n","from transformers import DataCollatorForLanguageModeling\n","from datasets import load_dataset\n","from tokenizers import ByteLevelBPETokenizer\n","\n","train_dataset = load_dataset('wikitext', 'wikitext-103-raw-v1', split=\"train[:1000]\")\n","\n","\n","# 한국어 말뭉치 준비\n","import os\n","\n","# 저장할 디렉토리 생성\n","if not os.path.exists('./text_data'):\n","    os.makedirs('./text_data')\n","\n","# 텍스트 파일로 데이터 저장\n","with open('./text_data/wikitext.txt', 'w', encoding='utf-8') as f:\n","    for data in train_dataset:\n","        f.write(data['text'] + '\\n')\n","\n","files = ['./text_data/wikitext.txt']\n","\n","\n","tokenizer = ByteLevelBPETokenizer()\n","tokenizer.train(files, vocab_size=32_000, min_frequency=2, special_tokens=[\n","    \"<s>\",\n","    \"<pad>\",\n","    \"</s>\",\n","    \"<unk>\",\n","    \"<mask>\",\n","])\n","\n","# 저장할 디렉토리 생성\n","if not os.path.exists('./my_gpt_model'):\n","    os.makedirs('./my_gpt_model')\n","\n","tokenizer.save_model(\"./my_gpt_model/\")\n","\n","\n","# 토크나이저의 단어 수\n","vocab_size = tokenizer.get_vocab_size()\n","\n","# GPT-2 모델 설정 정의\n","config = GPT2Config(\n","    vocab_size=vocab_size,\n","    bos_token_id=tokenizer.token_to_id(\"<s>\"),\n","    eos_token_id=tokenizer.token_to_id(\"</s>\"),\n",")\n","\n","# 빈 GPT-2 모델 생성\n","model = GPT2LMHeadModel(config)\n","\n","\n","new_tokenizer = GPT2Tokenizer.from_pretrained('my_gpt_model')\n","new_tokenizer.pad_token_id = tokenizer.token_to_id(\"<pad>\")\n","new_tokenizer.bos_token_id = tokenizer.token_to_id(\"<s>\")\n","new_tokenizer.eos_token_id = tokenizer.token_to_id(\"</s>\")\n","\n","new_tokenizer.save_pretrained('my_gpt_model') # 토크나이저 저장"],"metadata":{"id":"AXpXN7H30Opm","colab":{"base_uri":"https://localhost:8080/","height":328,"referenced_widgets":["e8ec615b0b3e43e2a8f24cc0339f25fb","df80d78d38204d02b4efa7fdca82abc3","2a1406f2c20943d68624ef6af55cf666","bc75e2d8a95249bda17e70619658ae68","f5a6a9ef69e94faabb94867f0397aad0","2bda755f15e8481999cdfbda60466255","90e9cdb951fd464a88eb24c64e0d6d54","7bdca5e9c7404de3bac6484e360d7be6","0c7094fd1c8e4493a32e36e5f1f7eb75","12b6073600eb44b58ebfceb7256dc3d8","2c757e202cc94c8499f1d86f5eeeeac7","0a1314c00dfb485b82e5b9a228df36db","27d5ca62a6d74f46a5fed8871953db83","bcb342c48069439081ee9e48966fb0d6","9cc5b30051ef4109879ede6af15cd19e","856c8e0a070b48e5bfb13fed477abb9f","30e966b266f5400e85a426e6c0a594b5","df45c37623f84155817c186d785606ce","ef33546dc3074256b5e3b1e7bf832ce5","8028dfe8434a4a819523917380218ee6","52b04c6fa0084e608b696525dea9ce77","61940c620e9549a29ff461de2ae55cbb","167da6826a3146f88d95aa71902adddd","0ad4a67955eb403bb0cd1d8e48e53987","18bf9397bba5444eba103e4328ed3bb9","66d87b81ecac4daeb45f7948c8eda4af","a89fba07609c49859fb2b131f07d9f69","761fe35d7b0c456bacda2ed16b7fb3bb","a7d7ff93adbe4b18a784ade56ce9e4ec","d959c3315bfa4d69b27e301ee89a18af","b1e47ec8bdd7484e96a0c36bb7329a1d","898548647e284091aee0afdf064b053e","de603f5f053a452b8c03a5d5a5b6715f","6762ef3b9b1248acb9b350b80c2e6c0d","cd60cb36cedf4d3280005ee98a4153a0","e93ac448e9cc41719d99bbd857d98160","ea1d23f2b2d040b6b8b3fb3f4c6a7513","2aba6af0412147639442b22ac7a4a7a1","a86c328f102844e583cfd5c33eb31cd3","06045c23e7bb43618544c491547fdd25","60f0b8149acd4a3687112b10c226ba94","368ddf5c8ed24894a3fa35b6d52503a9","158f3702d21d4cabbc60f287a11160c0","1abbb36c70c84dc788c5a29b1f87453c","8c0b460d5c0f4a69b35876071b74024a","6edca3c2c4ab4197ad352f0043cd9962","1cac9c89c0bf421a88cd211aec50760a","9aff13a43e6d43e1bfae8ee47bb58ca6","3b2945011f094095affaa2e12bd2bab3","a2b1a834b1c347cf8c0bf5c436578f2b","5b76ac8364844858b942fb7f4a88fc7f","f656afe181954e428456ff5997054ab1","4ff37285ae144a6b99cc114761772bcf","b06db40d895848ea894a74653dd2d61e","2f1c9982d75f472cbc4a41f8f4b3d0d4","8d3b89deae9d454c9a82481681520f37","145c15ff974c4d8baaca485b18af5a0e","9a82e6fb5d394892a2f702f7ddee91f9","8a174d32980545d1a4ccc37d6b39fae5","99cb41d62cbe424c927c9d76763aaf27","a0d507ae290b4c43b59f5b2316136885","85fbaae540b643db89111e89f979a9c9","47c5dddda6f34171b5f018ab8bfbaa97","106daa3b06d44d979b31874b8b239c66","7ad1febc7ab949b3978b6650b014dc3f","a6fb0093eb614ba58a8d2d00fd5e3e3e","e931ac63028448e7aab897b08a6709bd","56c4097b0b23459f9a35daf1174557ea","e3024ba2a508444784ed728cd6bc256a","44e47cb9bcef49728cc161577f45f80f","9bcdd34ca6f94b3aa5d935d078bf23a1","711af0ff54fc402db7b0c58c0d4f0615","0a8213d9e57045f8b6e900e9acf84484","abbd2c2bddb8454bb0b595cccd63c398","2ddbe07c2627470c96c875f21e84e660","7375f559f3584103968e5068373aa4fb","337448bde6de4937b38c1fe0f49aa16a"]},"executionInfo":{"status":"ok","timestamp":1712589147509,"user_tz":-540,"elapsed":109647,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"cea1e690-a778-41a6-8de1-98c84f9ec1e1"},"execution_count":48,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading data:   0%|          | 0.00/733k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e8ec615b0b3e43e2a8f24cc0339f25fb"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading data:   0%|          | 0.00/157M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0a1314c00dfb485b82e5b9a228df36db"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading data:   0%|          | 0.00/157M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"167da6826a3146f88d95aa71902adddd"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading data:   0%|          | 0.00/657k [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"6762ef3b9b1248acb9b350b80c2e6c0d"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating test split:   0%|          | 0/4358 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8c0b460d5c0f4a69b35876071b74024a"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating train split:   0%|          | 0/1801350 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"8d3b89deae9d454c9a82481681520f37"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Generating validation split:   0%|          | 0/3760 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e931ac63028448e7aab897b08a6709bd"}},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["('my_gpt_model/tokenizer_config.json',\n"," 'my_gpt_model/special_tokens_map.json',\n"," 'my_gpt_model/vocab.json',\n"," 'my_gpt_model/merges.txt',\n"," 'my_gpt_model/added_tokens.json')"]},"metadata":{},"execution_count":48}]},{"cell_type":"code","source":["tokenizer = GPT2Tokenizer.from_pretrained('my_gpt_model')\n","\n","def tokenize_function(examples):\n","    return tokenizer(examples[\"text\"])\n","\n","tokenized_datasets = train_dataset.map(tokenize_function, batched=True, num_proc=4, remove_columns=[\"text\"])\n","\n","data_collator = DataCollatorForLanguageModeling(tokenizer=tokenizer, mlm=False)\n","\n","\n","from transformers import Trainer, TrainingArguments\n","\n","training_args = TrainingArguments(\n","    output_dir=\"./my_gpt_model\",\n","    overwrite_output_dir=True,\n","    num_train_epochs=1,\n","    per_device_train_batch_size=8,\n","    save_steps=1000,\n","    save_total_limit=2,\n",")\n","\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=tokenized_datasets,\n","    data_collator=data_collator,\n",")\n","\n","trainer.train()"],"metadata":{"id":"Ho7sMf7X2haV","colab":{"base_uri":"https://localhost:8080/","height":231,"referenced_widgets":["a39c3e33871444259c68eebc70b157dc","09c010e0e4b44d3e8970505747aa714c","4ddac14d21ed4060bfb8817f94a5a54c","2c2aaac2005d445cb489667b8d611b78","229ffee694204b8aab06e7bb6a57b78a","7de9dc062be14915949acb48929da787","7b466dfadc7f4055a738a0d2a4e98f94","b45bc1e0bee2442081a12664ad8490c6","0bab75b4b35b4452acdaa2c329963328","7410443f96634a109fc0a12e67b5b964","0e1fc86039d04e168f5730b907957736"]},"executionInfo":{"status":"ok","timestamp":1712589196858,"user_tz":-540,"elapsed":49352,"user":{"displayName":"Cheonsol Lee","userId":"03882528540974429683"}},"outputId":"35d9d0f3-b40d-4138-fa32-9e8004364707"},"execution_count":49,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map (num_proc=4):   0%|          | 0/1000 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"a39c3e33871444259c68eebc70b157dc"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/accelerate/accelerator.py:436: FutureWarning: Passing the following arguments to `Accelerator` is deprecated and will be removed in version 1.0 of Accelerate: dict_keys(['dispatch_batches', 'split_batches', 'even_batches', 'use_seedable_sampler']). Please pass an `accelerate.DataLoaderConfiguration` instead: \n","dataloader_config = DataLoaderConfiguration(dispatch_batches=None, split_batches=False, even_batches=True, use_seedable_sampler=True)\n","  warnings.warn(\n"]},{"output_type":"display_data","data":{"text/plain":["<IPython.core.display.HTML object>"],"text/html":["\n","    <div>\n","      \n","      <progress value='125' max='125' style='width:300px; height:20px; vertical-align: middle;'></progress>\n","      [125/125 00:47, Epoch 1/1]\n","    </div>\n","    <table border=\"1\" class=\"dataframe\">\n","  <thead>\n"," <tr style=\"text-align: left;\">\n","      <th>Step</th>\n","      <th>Training Loss</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","  </tbody>\n","</table><p>"]},"metadata":{}},{"output_type":"execute_result","data":{"text/plain":["TrainOutput(global_step=125, training_loss=7.21770361328125, metrics={'train_runtime': 47.6256, 'train_samples_per_second': 20.997, 'train_steps_per_second': 2.625, 'total_flos': 110122343424000.0, 'train_loss': 7.21770361328125, 'epoch': 1.0})"]},"metadata":{},"execution_count":49}]},{"cell_type":"code","source":[],"metadata":{"id":"PWeMsT473Hfg"},"execution_count":null,"outputs":[]}]}